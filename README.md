## SPL Querying
In this Splunk lab, I explored various SPL queries to analyze security events and user activities. I started by querying _index="main"_ for all logged events to establish a baseline for system activity. Next, we focused on vendor sales activity, retrieving events associated with the "vendor_sales" host to monitor top sales performance. We then narrowed our analysis to the "mailsv" host, examining logs for failed login attempts to detect unauthorized access attempts. Finally, we specifically investigated failed _root_ login attempts on the mail server, uncovering multiple suspicious activities that pointed towards a potential _brute force_ attack. 
This lab helped me gain a practical understanding of how to search through indexed data and refine my results based on specific hosts and keywords, improving my ability to detect potential security incidents.

### Step 1: Query the Main Index for All Events
SPL Query: _index="main"_

This query fetches all events logged in the main index. It is the starting point for gathering unfiltered log data, which can be used to analyze general activity. Running this query helps identify broad trends or system-wide behaviors before applying filters.

![Screenshot 2024-09-07 132402](https://github.com/user-attachments/assets/025f40cd-a5fd-4e03-ae6a-a9a6d5a05468)
_These results displayed all recorded events in the _"main"_ index, showing log data across different hosts and sources. Showing varied event types, timestamps, and host details. This output serves as the base for deeper analysis._

### Step 2: Search for Vendor Sales Activity in Main Index
SPL Query: _index="main" host=vendor_sales_

In this step, the query is used to retrieve events related to the _"vendor_sales"_ host in the _"main"_ index. This query helps in analyzing sales-related system activity, such as monitoring the performance of the sales server.

![Screenshot 2024-09-07 132822](https://github.com/user-attachments/assets/a332d3c4-ce93-4086-979e-c6063ee86f72)
_The results revealed a comprehensive view of the top sales vendor with the corresponding VendorID #._ 

### Step3: Query Events for Specific Host
SPL Query: _index="main" host="mailsv"_

This query focuses on retrieving all events from the _main_ index that are associated with the _mailsv_ host. By narrowing the search to a specific host, you can analyze activities and logs for this machine exclusively, making it easier to identify patterns, issues, or anomalies related to that host.

![Screenshot 2024-09-07 132430](https://github.com/user-attachments/assets/e45989a3-8eac-48e3-9139-adf1e4ea39fc)
_The output displayed log events generated by the mailsv host. Results included timestamp, host, source, and any events on the server. These logs are showing multiple failed login attempts from unauthorized users. With these events being possible security incidents, let's further check our root user for IoCs._

### Step 4: Search for Failed Root Login Attempts on Mail Server
SPL Query: _index="main" host="mailsv" fail* root_

This step focuses on identifying failed login attempts specifically involving the root user on the _"mailsv"_ host (mail server). Using the wildcard _fail*_, we capture all variations of failure messages, such as _"failed"_ or _"failures"_. The goal is to extract logs that highlight security vulnerabilities or unauthorized attempts.

![Screenshot 2024-09-07 132452](https://github.com/user-attachments/assets/1c260451-88fc-4049-bc66-2ec43bcbd2bb)
_The output revealed logs from the main index indicating failed login attempts by the root user on the mailsv host. These events are critical for detecting unauthorized access attempts._ 

![Screenshot 2024-09-07 132550](https://github.com/user-attachments/assets/ba0354fd-95aa-4200-adf4-1cbe19048095)
_The results indicate a possible breach attempt, with multiple failed login attempts for the root user originating from various IPs and ports, all occurring at 1:39:51 AM. This pattern strongly suggests a brute force attack._

## Conclusion
In this lab, I gained significant insights into using Splunk's SPL for targeted log analysis and security monitoring. A key takeaway was the discovery of a potential brute-force attack through failed root login attempts on the mailsv host, identified by multiple failed login attempts from various IPs around the same timestamp. This highlighted the effectiveness of focused queries in uncovering critical security threats and reinforced the importance of continuous monitoring in safeguarding organizational data.
